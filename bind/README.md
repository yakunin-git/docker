# Bind

## О проекте

Быстрое развертывание DNS сервера Bind. Docker образ собирается самостоятельно из Dockerfile, на основе Ubuntu 20.04, но может быть развернут и на других версиях. В целом конфигурационные файлы подойдут для любой другой операционной системы, в том числе и на FreeBSD. Разница будет лишь в относительных путях до конфигурационных файлов. 
Данный образ подразумевает развертывание master сервера, не включая настройку slave.

## Развертывание

Для развертывания необходимо запустить docker compose up --build --detach. Образ будет собран автоматически. Обратите внимание на папку zone, она вынесена за пределы контейнера что бы файлы зон были доступны для редактирования. В папке conf расположен основной файл конфигурации. Его так же можно изменить перед сборкой контейнера.

```
.
├── conf
│   └── named.conf
├── docker-compose.yml
├── Dockerfile
├── README.md
└── zone
    ├── 0.0.127.in-addr.arpa.conf
    ├── main.conf
    └── mydomain.local.conf
```	


Структура выглядит следующим образом, папка conf содержит основной файл конфигурации сервера. Папка zone должна содержать ваши наборы конфигурации, то есть обслуживать ваши домены. Для примера тут расположены файлы, завязанные на локальный адрес, тестового домена mydomain.local. Обратите внимание что так же есть обратная зона для данного домена, так же привязанная к локальному адресу. Docker   запускается с параметрами сети – host. Что означает что вам не нужно прокидывать порты наружу, т.к., docker отдает управление сетью хостовой машине и после запуска сервер доступен на адресе 127.0.0.1:53


Если вы рассчитываете запускать сервер в «боевом режиме», перед запуском измените данный адрес на ваш внешний. В директиве listen-on

```
listen-on  {
    127.0.0.1;
  };
```

## Проверка и разрешение проблем

После запуска контейнера вы можете проверить статус и логи сервера.

```
docker exec -it bind-dns-server bash -c 'cat /var/log/bind.log'
```

Если контейнер не запустился:

```
docker logs -f bind-dns-server
```

Если запуск прошел успешно, можно проверить работу сервера:

```
# ping mydomain.local
Out:

PING mydomain.local (127.0.0.1) 56(84) bytes of data.
64 bytes from localhost (127.0.0.1): icmp_seq=1 ttl=64 time=0.085 ms
64 bytes from localhost (127.0.0.1): icmp_seq=2 ttl=64 time=0.066 ms

# host  127.0.0.1 127.0.0.1
Out:

Using domain server:
Name: 127.0.0.1
Address: 127.0.0.1#53
Aliases: 

1.0.0.127.in-addr.arpa domain name pointer mydomain.local.

# nslookup 127.0.0.1 127.0.0.1
Out:

nslookup 127.0.0.1 127.0.0.1
1.0.0.127.in-addr.arpa	name = mydomain.local.

# nslookup mydomain.local 127.0.0.1
Out:

Server:		127.0.0.1
Address:	127.0.0.1#53

Name:	mydomain.local
Address: 127.0.0.1

```
